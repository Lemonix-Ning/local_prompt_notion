Lumina Spirit Cat - è§†è§‰å½¢æ€å­¦ä¸åŸºç¡€éƒ¨ä»¶å®ç°

è¯¥æ–‡æ¡£è¯¦ç»†æ‹†è§£äº† Lumi çš„ SVG æ„é€ ã€‚Lumi ä¸æ˜¯ä¸€å¼ é™æ€å›¾ç‰‡ï¼Œè€Œæ˜¯ç”±å¤šä¸ªç‹¬ç«‹çš„ã€å¯åŠ¨ç”»çš„ SVG è·¯å¾„ (Paths) ç»„æˆçš„â€œçŸ¢é‡ç”Ÿç‰©â€ã€‚

1. æ„é€ æ‹†è§£ (Anatomy)

Lumi çš„èº«ä½“è¢«é™åˆ¶åœ¨ä¸€ä¸ª 100x100 çš„ SVG è§†å£ (viewBox) ä¸­ï¼Œå„éƒ¨ä½é€šè¿‡ç›¸å¯¹åæ ‡ç»˜åˆ¶ã€‚

A. èº«ä½“ (The Body)

å…ƒç´ : <motion.path>

ç»˜åˆ¶: ä½¿ç”¨ä¸‰æ¬¡è´å¡å°”æ›²çº¿ (C æŒ‡ä»¤) ç»˜åˆ¶ä¸€ä¸ªç±»åœ†å½¢çš„â€œé¦’å¤´â€å½¢çŠ¶ã€‚

åŠ¨ç”»èƒ½åŠ›:

å‘¼å¸: é€šè¿‡å¾®è°ƒæ§åˆ¶ç‚¹åæ ‡ï¼Œå®ç°èƒ¸å»“èµ·ä¼ã€‚

å˜å½¢: åœ¨ä¸åŒçŠ¶æ€ï¼ˆå¦‚ç¡è§‰ã€æ€è€ƒï¼‰ä¸‹ï¼Œæ”¹å˜ d å±æ€§è·¯å¾„ï¼Œå®ç°å½¢çŠ¶åˆ‡æ¢ã€‚

B. çœ¼ç› (The Eyes)

å…ƒç´ : ç»„åˆ (<g>) + æ¤­åœ† (<motion.ellipse>)

å±‚çº§: åŒ…å«åº•è‰²ã€ç³å­”ã€é«˜å…‰ç‚¹ã€‚

åŠ¨ç”»èƒ½åŠ›:

çœ¨çœ¼: å°†å‚ç›´åŠå¾„ ry ä» 8 åŠ¨ç”»è¿‡æ¸¡åˆ° 0.5ã€‚

æ³¨è§†: é€šè¿‡ pupilX/Y ä½ç§»æ•´ä¸ªçœ¼çƒç»„ã€‚

å˜èº«: é€šè¿‡æ¡ä»¶æ¸²æŸ“ï¼Œå°†æ¤­åœ†æ›¿æ¢ä¸ºå…¶ä»– SVG è·¯å¾„ï¼ˆå¦‚ +, x, â™¥ï¼‰ã€‚

C. å°¾å·´ (The Tail)

å…ƒç´ : <motion.path>

å±‚çº§: z-index: -1 (ä½äºèº«ä½“åæ–¹)ã€‚

ç»˜åˆ¶: ä¸€æ¡è¾ƒç²—çš„æè¾¹è·¯å¾„ (strokeWidth="6")ã€‚

åŠ¨ç”»èƒ½åŠ›: æ‘†åŠ¨ (Wagging)ã€‚é€šè¿‡å…³é”®å¸§å¾ªç¯æ”¹å˜è´å¡å°”æ›²çº¿çš„æ§åˆ¶ç‚¹ï¼Œæ¨¡æ‹Ÿæ­£å¼¦æ³¢æ‘†åŠ¨ã€‚

D. çˆªå­ (The Paws)

å…ƒç´ : <motion.ellipse>

ç­–ç•¥: æ ¹æ® orientation (å¸é™„æ–¹å‘) æ”¹å˜å½¢æ€ã€‚

Bottom: æ‰æ¤­åœ†ï¼Œæ¨¡æ‹Ÿè¶´åœ¨å¹³é¢ä¸Šã€‚

Side/Top: æ­£åœ†ï¼Œæ¨¡æ‹Ÿè‚‰çƒå¸é™„åœ¨ç»ç’ƒä¸Šã€‚

E. å…‰ç¯ (The Aura)

å…ƒç´ : HTML <div> + CSS Border

æ ·å¼: è™šçº¿è¾¹æ¡† (border-dashed)ã€‚

åŠ¨ç”»: æ— é™æ—‹è½¬ (rotate: 360deg)ï¼Œé€Ÿåº¦éšçŠ¶æ€æ”¹å˜ï¼ˆæ€è€ƒæ—¶å˜å¿«ï¼‰ã€‚

2. å…³é”®æŠ€æœ¯ç‚¹

2.1 é¢œè‰²ç³»ç»Ÿ (Theming)

æ‰€æœ‰ SVG çš„ fill å’Œ stroke å‡ä¸ç¡¬ç¼–ç é¢œè‰²å€¼ï¼Œè€Œæ˜¯ä» colors[theme] å¯¹è±¡ä¸­è¯»å–ã€‚

Light: å®ä½“æ„Ÿå¼ºï¼Œæ·±è‰²å¡«å……ã€‚

Dark: çµä½“æ„Ÿå¼ºï¼Œæµ…è‰²å¡«å…… + å‘å…‰ã€‚

2.2 åŠ¨ä½œç¼–æ’ (Orchestration)

ä½¿ç”¨ Framer Motion çš„ variants å’Œ animate å±æ€§ã€‚

Idle: y: [-4, 4, -4] (æ‚¬æµ®)ã€‚

Sleep: scaleY: 0.95 (è¶´ä¸‹)ã€‚

Windy: d è·¯å¾„å˜å½¢ (è€³æœµåå€’)ã€‚

import React, { useState, useEffect } from 'react';
import { motion, AnimatePresence } from 'framer-motion';

// å®šä¹‰æ¥å£ï¼Œç¡®ä¿ç±»å‹å®‰å…¨
interface SpiritCatProps {
  orientation: 'bottom' | 'left' | 'right' | 'top'; // å¸é™„æ–¹å‘
  mode: string;                                     // å½“å‰è¡Œä¸ºæ¨¡å¼ (idle, sleep, create...)
  theme: 'light' | 'dark';                          // ä¸»é¢˜
  pupilX?: any;                                     // çœ¼ç¥è·Ÿéš X (MotionValue)
  pupilY?: any;                                     // çœ¼ç¥è·Ÿéš Y (MotionValue)
  blink?: boolean;                                  // å¼ºåˆ¶çœ¨çœ¼æ§åˆ¶ (å¯é€‰)
}

export const SpiritCat: React.FC<SpiritCatProps> = ({ 
  orientation, 
  mode, 
  theme, 
  pupilX, 
  pupilY, 
  blink: externalBlink 
}) => {
  // å†…éƒ¨çœ¨çœ¼çŠ¶æ€
  const [internalBlink, setInternalBlink] = useState(false);
  
  // 1. è‡ªåŠ¨çœ¨çœ¼é€»è¾‘ (Auto Blink Loop)
  useEffect(() => {
    // ç‰¹æ®Šæ¨¡å¼ä¸‹ç¦æ­¢è‡ªåŠ¨çœ¨çœ¼ (å¦‚ç¡çœ ã€åˆ é™¤ã€æœç´¢ç­‰)
    if (mode === 'sleep' || mode === 'search' || mode === 'delete') {
        setInternalBlink(false);
        return;
    }

    const timer = setInterval(() => {
      setInternalBlink(true);
      setTimeout(() => setInternalBlink(false), 200); // é—­çœ¼ 200ms
    }, 4000 + Math.random() * 2000); // éšæœºé—´éš” 4~6ç§’

    return () => clearInterval(timer);
  }, [mode]);

  const isBlinking = externalBlink || internalBlink;

  // 2. é¢œè‰²é…ç½® (Color Palette)
  const c = {
    body: theme === 'dark' ? "#E2E8F0" : "#334155", // Light: Slate-700, Dark: Slate-200
    stroke: theme === 'dark' ? "#94A3B8" : "#1E293B",
    paw: theme === 'dark' ? "#E2E8F0" : "#334155",
    
    // çœ¼ç›çŠ¶æ€è‰²
    eyeNormal: theme === 'dark' ? "#FBBF24" : "#F59E0B", // Amber
    eyeSleep: theme === 'dark' ? "#94A3B8" : "#475569",  // Grey
    eyeSearch: "#10B981", // Emerald
    eyeCreate: "#22D3EE", // Cyan
    eyeFolder: "#F97316", // Orange
    eyeDelete: "#EF4444", // Red
    eyeMagic: "#2DD4BF",  // Teal
    eyeLove: "#EC4899",   // Pink
    eyePin: "#F59E0B"     // Gold
  };

  // 3. å†³å®šå½“å‰çœ¼ç›é¢œè‰²
  let eyeColor = c.eyeNormal;
  if (mode === 'search') eyeColor = c.eyeSearch;
  if (mode === 'create_card') eyeColor = c.eyeCreate;
  if (mode === 'create_folder') eyeColor = c.eyeFolder;
  if (mode === 'update' || mode === 'clipboard') eyeColor = c.eyeSuccess; // Green
  if (mode === 'delete') eyeColor = c.eyeDelete;
  if (mode === 'restore') eyeColor = c.eyeMagic;
  if (mode === 'favorite') eyeColor = c.eyeLove;
  if (mode === 'pin') eyeColor = c.eyePin;
  if (mode === 'sleep') eyeColor = c.eyeSleep;

  return (
    <motion.div 
      className="relative w-full h-full"
      // æ•´ä½“æ—‹è½¬ï¼šæ ¹æ®å¸é™„æ–¹å‘è°ƒæ•´èº«ä½“æœå‘
      animate={orientation}
      variants={{
        bottom: { rotate: 0 },
        left: { rotate: 0 }, // æˆ– 90 (å¦‚æœæƒ³è®©å®ƒè¶´å¢™ä¸Š)
        right: { rotate: 0 },
        top: { rotate: 0 }
      }}
      transition={{ type: "spring", stiffness: 200, damping: 20 }}
    >
      <motion.div
        className="w-full h-full"
        style={{ transformOrigin: "bottom center" }}
        // --- 4. èº«ä½“ç‰©ç†åŠ¨ä½œç¼–æ’ (Physical Choreography) ---
        animate={
            mode === 'sleep' ? { scaleY: 0.95 } : // ç¡çœ ï¼šèº«ä½“å‹ä½
            mode === 'windy' ? { y: 4, scaleY: 0.95 } : // é£é˜»ï¼šå‹ä½æŠ—é£
            mode === 'create_card' ? { y: [0, -15, 0], scale: [1, 1.1, 1] } : // è·³è·ƒ
            mode === 'create_folder' ? { rotate: [0, -5, 5, -5, 5, 0] } : // æ‘‡æ‘†
            mode === 'update' ? { y: [0, 6, 0], scaleY: [1, 0.92, 1] } : // ç‚¹å¤´
            mode === 'clipboard' ? { y: [0, 8, 0] } : // å¤åˆ¶ç‚¹å¤´
            mode === 'delete' ? { rotate: [0, -5, 5, -5, 5, 0] } : // æƒŠæéœ‡åŠ¨
            mode === 'restore' ? { y: -15, rotate: [0, -2, 2, 0] } : // æ‚¬æµ®æ–½æ³•
            mode === 'favorite' ? { scaleX: 0.9, scaleY: 1.05, y: -5 } : // æ‹¥æŠ±æ”¶ç¼©
            mode === 'pin' ? { y: -20, scaleY: 1.15, scaleX: 0.9 } : // å‘ä¸Šä¼¸å±•
            orientation !== 'bottom' ? { y: [-4, 4, -4] } : // é»˜è®¤ï¼šæ‚¬æµ®å‘¼å¸
            { y: 0 }
        }
        transition={{ 
            // äº¤äº’åŠ¨ä½œå¿«(0.3s)ï¼Œé—²ç½®å‘¼å¸æ…¢(3s)
            y: { duration: (mode === 'idle' || mode === 'restore') ? 3 : 0.3, repeat: (mode === 'idle' || mode === 'restore') ? Infinity : 0, ease: "easeInOut" },
            default: { duration: 0.3 }
        }}
      >
        {/* --- 5. èƒ½é‡å…‰ç¯ (The Aura) --- */}
        <motion.div
           className={`absolute inset-0 rounded-full border-2 border-dashed ${theme === 'dark' ? 'border-indigo-400/50' : 'border-indigo-500/20'}`}
           animate={{ 
             rotate: mode === 'restore' ? -360 : 360, // æ¢å¤æ—¶é€†æ—¶é’ˆ(æ—¶å…‰å€’æµ)
             scale: mode !== 'idle' && mode !== 'sleep' ? 1.2 : 1, 
             opacity: mode === 'sleep' ? 0 : (mode !== 'idle' ? 0.8 : 0.2), // ç¡çœ æ—¶éšè—
             borderColor: mode !== 'idle' ? eyeColor : undefined // å…‰ç¯éšçœ¼ç›å˜è‰²
           }}
           transition={{ rotate: { duration: mode === 'restore' ? 5 : 10, repeat: Infinity, ease: "linear" } }}
        />
        
        {/* --- 6. SVG çŸ¢é‡ç»˜å›¾ (The Vector Body) --- */}
        <motion.svg viewBox="0 0 100 100" className="w-full h-full drop-shadow-xl relative z-10">
           <motion.g initial="idle">
             {/* A. èº«ä½“èº¯å¹² */}
             <motion.path
               d="M 50 20 C 75 20 85 40 85 60 C 85 85 70 95 50 95 C 30 95 15 85 15 60 C 15 40 25 20 50 20 Z"
               fill={c.body} stroke={c.stroke} strokeWidth="2"
             />

             {/* B. è€³æœµ (åŠ¨æ€å˜å½¢) */}
             {/* å·¦è€³ */}
             <motion.path 
                // æ­£å¸¸: ç«–ç«‹ | åˆ®é£: å‘åå¹³è´´ (é£æœºè€³)
                animate={{ d: mode === 'windy' ? "M 30 25 L 15 20 L 45 22" : "M 30 25 L 20 5 L 45 22" }}
                fill={c.body} stroke={c.stroke} strokeWidth="2" transition={{ duration: 0.2 }}
             />
             {/* å³è€³ */}
             <motion.path 
                animate={{ d: mode === 'windy' ? "M 70 25 L 85 20 L 55 22" : "M 70 25 L 80 5 L 55 22" }}
                fill={c.body} stroke={c.stroke} strokeWidth="2" transition={{ duration: 0.2 }}
             />
             
             {/* C. é¢éƒ¨äº”å®˜ç»„ */}
             <g transform="translate(0, 5)">
                {/* --- çœ¼ç›å˜å½¢çŸ©é˜µ --- */}
                {mode === 'create_card' ? (
                   // å½¢æ€ï¼šåŠ å· (+)
                   <g stroke={eyeColor} strokeWidth="3" strokeLinecap="round">
                      <path d="M 35 46 V 54" /> <path d="M 31 50 H 39" />
                      <path d="M 65 46 V 54" /> <path d="M 61 50 H 69" />
                   </g>
                ) : mode === 'create_folder' ? (
                   // å½¢æ€ï¼šæ–¹å— (â– )
                   <g fill={eyeColor}>
                      <rect x="31" y="46" width="8" height="8" rx="1" />
                      <rect x="61" y="46" width="8" height="8" rx="1" />
                   </g>
                ) : mode === 'delete' ? (
                   // å½¢æ€ï¼šå‰å· (X)
                   <g stroke={eyeColor} strokeWidth="3" strokeLinecap="round">
                      <path d="M 30 46 L 40 56" /> <path d="M 40 46 L 30 56" />
                      <path d="M 60 46 L 70 56" /> <path d="M 70 46 L 60 56" />
                   </g>
                ) : mode === 'update' || mode === 'clipboard' ? (
                   // å½¢æ€ï¼šå¯¹é’© (âœ“)
                   <g stroke={eyeColor} strokeWidth="3" strokeLinecap="round" fill="none">
                      <path d="M 28 50 L 33 55 L 42 45" />
                      <path d="M 58 50 L 63 55 L 72 45" />
                   </g>
                ) : mode === 'favorite' ? (
                   // å½¢æ€ï¼šçˆ±å¿ƒ (â™¥)
                   <g fill={eyeColor}>
                      <path d="M 35 47 C 32 44 27 47 30 51 C 33 55 35 58 35 58 C 35 58 37 55 40 51 C 43 47 38 44 35 47" />
                      <path d="M 65 47 C 62 44 57 47 60 51 C 63 55 65 58 65 58 C 65 58 67 55 70 51 C 73 47 68 44 65 47" />
                   </g>
                ) : mode === 'restore' ? (
                   // å½¢æ€ï¼šæ˜Ÿæ˜Ÿ (âœ¨)
                   <g fill={eyeColor}>
                      <path d="M 35 44 L 36.5 48.5 L 41 50 L 36.5 51.5 L 35 56 L 33.5 51.5 L 29 50 L 33.5 48.5 Z" />
                      <path d="M 65 44 L 66.5 48.5 L 71 50 L 66.5 51.5 L 65 56 L 63.5 51.5 L 59 50 L 63.5 48.5 Z" />
                   </g>
                ) : mode === 'search' ? (
                   // å½¢æ€ï¼šä¾¦æ¢çœ¼é•œ (ğŸ‘“)
                    <g stroke={eyeColor} strokeWidth="2" fill="rgba(255,255,255,0.15)">
                      <circle cx="35" cy="50" r="11" />
                      <circle cx="65" cy="50" r="11" />
                      <path d="M 46 50 Q 50 45 54 50" fill="none" />
                      <path d="M 24 50 L 15 45" />
                      <path d="M 76 50 L 85 45" />
                    </g>
                ) : (
                   // å½¢æ€ï¼šæ­£å¸¸æ¤­åœ† (æ”¯æŒ Gaze Tracking å’Œ ç¡çœ é—­çœ¼)
                   <>
                      <motion.ellipse 
                        cx="35" cy="50" rx="6" 
                        animate={{ 
                            ry: (mode === 'sleep' || isBlinking || mode === 'windy') ? 0.5 : 8, // é—­çœ¼: ry=0.5
                            cy: mode === 'pin' ? 40 : 50 // ç½®é¡¶: å‘ä¸Šçœ‹
                        }} 
                        fill={eyeColor} 
                        style={mode === 'idle' ? { x: pupilX, y: pupilY } : {}} // ç»‘å®šçœ¼ç¥è·Ÿéš
                      />
                      {/* é«˜å…‰ç‚¹ */}
                      <motion.circle 
                        cx="37" cy="46" r="2" fill="white" opacity="0.8" 
                        animate={{ opacity: mode === 'sleep' ? 0 : 0.8, cy: mode === 'pin' ? 36 : 46 }}
                        style={mode === 'idle' ? { x: pupilX, y: pupilY } : {}}
                      />
                      
                      <motion.ellipse 
                        cx="65" cy="50" rx="6" 
                        animate={{ 
                            ry: (mode === 'sleep' || isBlinking || mode === 'windy') ? 0.5 : 8,
                            cy: mode === 'pin' ? 40 : 50
                        }} 
                        fill={eyeColor} 
                        style={mode === 'idle' ? { x: pupilX, y: pupilY } : {}}
                      />
                      <motion.circle 
                        cx="67" cy="46" r="2" fill="white" opacity="0.8" 
                        animate={{ opacity: mode === 'sleep' ? 0 : 0.8, cy: mode === 'pin' ? 36 : 46 }}
                        style={mode === 'idle' ? { x: pupilX, y: pupilY } : {}}
                      />
                   </>
                )}
             </g>

             {/* D. çˆªå­ (The Paws) */}
             <AnimatePresence>
                {/* æ‚¬æµ®æ—¶ï¼šåœ†å½¢è‚‰çƒ */}
                {orientation !== 'bottom' && (
                <motion.g initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }}>
                    <circle cx="20" cy="70" r="6" fill={c.paw} stroke={c.stroke} />
                    <circle cx="80" cy="70" r="6" fill={c.paw} stroke={c.stroke} />
                </motion.g>
                )}
                {/* è½åœ°æ—¶ï¼šæ‰æ¤­åœ†æ‰‹ */}
                {orientation === 'bottom' && (
                <motion.g initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }}>
                    <motion.ellipse 
                        animate={{ 
                            cx: mode === 'favorite' ? 45 : 40, // æ‹¥æŠ±æ—¶å†…ç§»
                            cy: mode === 'pin' ? 65 : 85,      // ç½®é¡¶æ—¶ä¸Šä¸¾
                            rotate: mode === 'favorite' ? -15 : 0 
                        }}
                        rx="5" ry="4" fill={c.paw} 
                    />
                    <motion.ellipse 
                        animate={{ 
                            cx: mode === 'favorite' ? 55 : 60, 
                            cy: mode === 'pin' ? 65 : 85,
                            rotate: mode === 'favorite' ? 15 : 0 
                        }}
                        rx="5" ry="4" fill={c.paw} 
                    />
                </motion.g>
                )}
             </AnimatePresence>

             {/* E. å°¾å·´ (The Tail) */}
             <motion.path 
                d="M 50 85 Q 80 100 90 80" 
                stroke={c.body} strokeWidth="6" fill="none" strokeLinecap="round"
                style={{ zIndex: -1 }} // ä½äºèº«ä½“åæ–¹
                animate={mode === 'update' 
                   ? { d: "M 50 85 Q 50 80 50 70" } // ç«–ç›´å°¾å·´ (å¼€å¿ƒ)
                   : { d: ["M 50 85 Q 80 100 90 80", "M 50 85 Q 90 90 95 70", "M 50 85 Q 80 100 90 80"] }
                }
                // ç¡çœ æ—¶æ‘†åŠ¨å˜æ…¢ (6s)ï¼Œå¹³æ—¶ (3s)
                transition={{ duration: mode === 'sleep' ? 6 : 3, repeat: Infinity, ease: "easeInOut" }}
             />
           </motion.g>
        </motion.svg>
      </motion.div>
    </motion.div>
  );
};
